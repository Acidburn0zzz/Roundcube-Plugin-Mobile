function add_mobile_class(a,b){var c=$(document.createElement("span")),d=$(b.obj),e=d.find("span.mobile_text");if(e.addClass(d.find("span.mobile_class").text()),c.text(e.text()),e.html(""),e.append(c),rcmail.env.showcontactsphotos){var f=$(document.createElement("img"));f.hide().on("load",function(){$(this).show(),e.find("span").hide()}).error(function(){$(this).hide()}).attr("src",rcmail.env.contactphotourl+"&_error=1&_email="+d.find("span.rcmContactAddress").attr("title")),e.append(f)}}function load_next_page(){var a=window.current_page_scroll;if(a>0&&a<=rcmail.env.pagecount&&!window.page_loading[a]){window.page_loading[a]=!0;var b=rcmail.set_busy(!0,"loading"),c={};c._mbox=rcmail.env.mailbox,c._page=a,rcmail.env.search_request&&(c._search=rcmail.env.search_request),rcmail.http_request("list",c,b)}}function show_uploadform(){var a=$("#upload-dialog");return a.is(":visible")?void a.dialog("close"):("compose"!=rcmail.env.action||a.data("extended")||($("<a>").addClass("iconlink add").attr("href","#add").html("Add").appendTo($('input[type="file"]',a).parent()).click(add_uploadfile),a.data("extended",!0)),a.dialog({modal:!0,resizable:!1,closeOnEscape:!0,title:a.attr("title"),close:function(){try{$("#upload-dialog form").get(0).reset()}catch(a){}a.dialog("destroy").hide(),$("div.addline",a).remove()},width:480}).show(),void(document.all||$("input[type=file]",a).first().click()))}function add_uploadfile(a){var b=$(this).parent(),c=b.clone().addClass("addline").insertAfter(b);c.children(".iconlink").click(add_uploadfile),c.children("input").val(""),document.all||$("input[type=file]",c).click()}function show_header_row(a,b){var c=$("#compose-"+a);if(!c.is(":visible"))return compose_headers[a]&&!b&&$("#_"+a).val(compose_headers[a]),c.show(),$("#"+a+"-link").hide(),!1}function hide_header_row(a){var b=$("#_"+a);return compose_headers[a]=b.val(),b.val(""),$("#compose-"+a).hide(),$("#"+a+"-link").show(),!1}function toggleFullScreen(){var a=window.document,b=a.documentElement,c=b.requestFullscreen||b.mozRequestFullScreen||b.webkitRequestFullScreen||b.msRequestFullscreen,d=a.exitFullscreen||a.mozCancelFullScreen||a.webkitExitFullscreen||a.msExitFullscreen;a.fullscreenElement||a.mozFullScreenElement||a.webkitFullscreenElement||a.msFullscreenElement?d.call(a):(c.call(b),setTimeout(function(){window.scrollTo(0,1)},100))}var page_loading,current_page_scroll,current_uid,previous_page,timer,show_timer,checkmail_timer,touchstart_timer,storePosition={topCoordinate:null};$(document).on("pagecreate",".jqm-calendar",function(){$(document).on("swipeleft swiperight","#calendar",function(a){"swipeleft"===a.type?$("#calendar").fullCalendar("next"):$("#calendar").fullCalendar("prev")}),$("html").keydown(function(a){37==a.which?$("#calendar").fullCalendar("prev"):39==a.which&&$("#calendar").fullCalendar("next")}),$(".jqm_calendar_previous").click(function(a){$("#calendar").fullCalendar("prev")}),$(".jqm_calendar_next").click(function(a){$("#calendar").fullCalendar("next")})}),$(document).on("pageshow",".jqm-compose",function(){$("#compose-subject").click(function(){$("#compose-subject input").focus()})}),$(document).on("pageshow","#page_mail_list",function(){null!==window.storePosition.topCoordinate&&$.mobile.silentScroll(window.storePosition.topCoordinate),$(".jqm-mail-more-buttons-header a.move").click(function(){setTimeout(function(){$("#folder-selector").css({left:($(document).width()-$("#folder-selector").width())/2,top:50})},50)})}),$(document).on("click","#messagelist a",function(a){return a.preventDefault(),!1}),$(document).on("pageshow","#page_addressbook_list",function(){null!==window.storePosition.topCoordinate&&$.mobile.silentScroll(window.storePosition.topCoordinate)}),$(document).on("pageshow",".jqm-message",function(){if($("#buttons-right-panel a").click(function(){setTimeout(function(){$("#folder-selector").css({left:($(document).width()-$("#folder-selector").width())/2,top:50}),$("#buttons-right-panel").panel("close")},50)}),window.current_uid){$(".jqm_message_list_group").show(),$(".rc_message_back").hide();var a=rcmail.message_list.get_next_row(),b=rcmail.message_list.get_prev_row();a?$(".jqm_message_next").show():($(".jqm_message_next").hide(),load_next_page()),b?$(".jqm_message_previous").show():$(".jqm_message_previous").hide(),rcmail.env.uid=window.current_uid,rcmail.env.action="show",rcmail.env.messages[window.current_uid].flags&&jQuery.each(rcmail.env.messages[window.current_uid].flags.tb_labels,function(a,b){rcm_tb_label_flag_msgs([-1],b)}),$("#attachment-list li").length||($("div.rightcol").hide(),$("div.leftcol").css("margin-right","0")),$("#messagebody img").each(function(){if("program/resources/blocked.gif"==$(this).attr("src"))return $("#remote-objects-message").show(),void rcmail.enable_command("load-images","always-load",!0)}),rcmail.env.isenigma&&"#messagebody div.enigmaerror".length&&($("#messagebody div.enigmaerror").html($("#messagebody div.enigmaerror").html()+" "+rcmail.gettext("mobile.addenigmapass")),$("#messagebody div.enigmaerror").click(function(){rcmail.env.enigma_password_request?rcmail.enigma_password_request(rcmail.env.enigma_password_request):window.location.reload()}));var c=["show","reply","reply-all","reply-list","move","copy","delete","open","mark","edit","viewsource","print","load-attachment","download-attachment","show-headers","hide-headers","download","forward","forward-inline","forward-attachment","change-format"];rcmail.enable_command(c,rcmail.env.uid),$("#countcontrols").hide(),rcmail.addEventListener("responseafterlist",function(a){var b=rcmail.message_list.get_next_row();b&&$(".jqm_message_next").show()}),rcmail.addEventListener("actionafter",function(a){if("mark"==a.action){if("unread"==a.props)rcmail.set_message(rcmail.env.uid,"unread",!0);else{if("read"!=a.props)return;rcmail.set_message(rcmail.env.uid,"unread",!1)}"page_mail_list"!=$.mobile.pageContainer.pagecontainer("getActivePage")[0].id&&$.mobile.pageContainer.pagecontainer("change",$("#page_mail_list"))}}),rcmail.addEventListener("responseaftermove",function(a){window.previous_page="current_page","page_mail_list"!=$.mobile.pageContainer.pagecontainer("getActivePage")[0].id&&("page_mail_list"==window.previous_page?$.mobile.back():$.mobile.pageContainer.pagecontainer("change",$("#page_mail_list")))}),rcmail.addEventListener("responseafterdelete",function(a){window.previous_page="current_page","page_mail_list"!=$.mobile.pageContainer.pagecontainer("getActivePage")[0].id&&("page_mail_list"==window.previous_page?$.mobile.back():$.mobile.pageContainer.pagecontainer("change",$("#page_mail_list")))})}}),$(document).on("pagecreate",".jqm-message",function(){window.previous_page&&($(".jqm_message_list").click(function(a){"page_mail_list"==window.previous_page?(window.previous_page="current_page",$.mobile.back()):(window.previous_page="current_page",$.mobile.pageContainer.pagecontainer("change",$("#page_mail_list"))),a.preventDefault()}),$(".jqm_message_previous").click(function(a){var b=rcmail.message_list.get_row_uid(rcmail.message_list.get_prev_row());window.current_uid=b,rcmail.message_list.last_selected=b,window.previous_page="current_page",rcmail.set_message(b,"unread",!1),rcmail.show_message_mobile(b,{}),window.storePosition.topCoordinate-=76,a.preventDefault()}),$(".jqm_message_next").click(function(a){var b=rcmail.message_list.get_row_uid(rcmail.message_list.get_next_row());window.current_uid=b,rcmail.message_list.last_selected=b,window.previous_page="current_page",rcmail.set_message(b,"unread",!1),rcmail.show_message_mobile(b,{}),window.storePosition.topCoordinate+=76,a.preventDefault()}),$("#attachment-list li a").click(function(){$(this).attr("target","_blank"),$(this).attr("onlick","")}),$(".image-attachment a").click(function(){$(this).attr("target","_blank"),$(this).attr("onlick","")}),$(".zipdownload").hide())}),$(document).on("pageshow",".jqm-contact",function(){window.current_uid&&($(".jqm_contact_list_group").show(),$(".rc_contact_back").hide(),rcmail.env.cid=window.current_uid,rcmail.env.action="show",rcmail.enable_command("show","edit",!0),$("input.groupmember").change(function(){rcmail.group_member_change(this.checked?"add":"del",rcmail.env.cid,rcmail.env.source,this.value)}))}),$(document).on("pagecreate",".jqm-contact",function(){if(window.previous_page){var a=!0;$(document).on("swipeleft swiperight",".jqm-contact",function(b){a&&(a=!1,setTimeout(function(){a=!0},900))}),$(".jqm_contact_list").click(function(a){"page_addressbook_list"==window.previous_page?(window.previous_page="current_page",$.mobile.back()):(window.previous_page="current_page",$.mobile.pageContainer.pagecontainer("change",$("#page_addressbook_list"))),a.preventDefault()}),$(".contactcontrollerphone .contactfieldcontent.text").each(function(){$(this).html('<a href="tel:'+$(this).html()+'">'+$(this).html()+"</a>")}),rcmail.register_command("delete_mobile",rcmail.delete_contact_mobile,!rcmail.env.readonly)}}),$(document).on("pageshow",".jqm-plugin",function(){$(".ui-button-disabled").removeClass("ui-button-disabled").removeClass("ui-state-disabled")}),$(document).on("pageshow",".jqm-enigma-key-import",function(){$(".ui-button-disabled").removeClass("ui-button-disabled").removeClass("ui-state-disabled")}),$(document).on("pageloadfailed",function(a,b){a.preventDefault()}),$(document).ready(function(){if($("#mailboxlist").attr("data-role","listview"),$("#mailboxlist ul").attr("data-role","listview"),$("#mailboxlist ul").show(),$("#mailboxlist li").attr("data-icon","false"),$("#mailboxlist div.treetoggle").hide(),rcmail.addEventListener("insertrow",function(a){add_mobile_class(a.uid,a.row)}),$("#quicksearchbox").attr("placeholder","Search..."),$("#quicksearchbox").attr("data-type","search"),$("#directorylist_mobile").attr("data-role","listview"),$("#directorylist_mobile ul").attr("data-role","listview"),$("#directorylist_mobile ul").show(),$("#directorylist_mobile > li").attr("data-icon","user"),$("#directorylist_mobile li li").attr("data-icon","false"),$("#directorylist_mobile div.treetoggle").hide(),$("#calendarslist").attr("data-role","listview"),$("#calendarslist ul").attr("data-role","listview"),$("#calendarslist div.treetoggle").hide(),$("#settingslist_mobile").attr("data-role","listview"),$("#settingslist_mobile a").attr("data-ajax","false"),$("#settingslist_mobile ul").attr("data-role","listview"),$("#settingslist_mobile ul").show(),$("#settingslist_mobile > li").attr("data-icon","user"),$("#settingslist_mobile li li").attr("data-icon","false"),$("#settingslist_mobile div.treetoggle").hide(),$("#subscription-table").attr("data-role","listview"),$("#subscription-table ul").attr("data-role","listview"),$("#subscription-table ul").show(),$("#subscription-table li").attr("data-icon","carat-r"),$("#subscription-table div.treetoggle").hide(),$("#eventedit").length&&$("#eventedit .edit-alarm-type").selectmenu(),$("#apps-right-panel .button-switch_desktop").length){var a=$("#apps-right-panel .button-switch_desktop").get(0).outerHTML;$("#apps-right-panel .button-switch_desktop").remove(),$("#apps-right-panel .button-logout").before(a)}if($("#apps-right-panel .button-calendar").length){var a=$("#apps-right-panel .button-calendar").get(0).outerHTML;$("#apps-right-panel .button-calendar").remove(),$("#apps-right-panel .button-settings").before(a)}if($("#apps-right-panel .button-melanie2_moncompte").length){var a=$("#apps-right-panel .button-melanie2_moncompte").get(0).outerHTML;$("#apps-right-panel .button-melanie2_moncompte").remove(),$("#apps-right-panel .button-settings").before(a)}if($("#apps-right-panel .button-melanie2_sondage").length){var a=$("#apps-right-panel .button-melanie2_sondage").get(0).outerHTML;$("#apps-right-panel .button-melanie2_sondage").remove(),$("#apps-right-panel .button-settings").before(a)}if($("#apps-right-panel .button-melanie2_jabber").length){var a=$("#apps-right-panel .button-melanie2_jabber").get(0).outerHTML;$("#apps-right-panel .button-melanie2_jabber").remove(),$("#apps-right-panel .button-settings").before(a)}}),$(document).bind("mobileinit",function(){$.mobile.page.prototype.options.domCache=!1,$.mobile.ajaxLinksEnabled=!1}),window.rcmail&&(rcmail.addEventListener("init",function(a){if(rcmail.env.isenigma&&(rcmail.enigma_password_request=function(a){if(a&&a.keyid){var b=this,c=this.get_label("enigma.enterkeypass"),d=$("<div>").attr({"data-role":"popup",id:"passwordrequestpopup","data-theme":"f",class:"ui-corner-all prompt"}),e=$("<form>").appendTo(d),f=$("<div>").attr({style:"padding:10px 20px;"}).appendTo(e),g=$("<h3>").appendTo(f),h=$("<input>").attr({name:"keypassword",id:"enigmakeypassword",type:"password"}).appendTo(f);$("<button>").attr({type:"submit","data-theme":"f","data-icon":"check"}).text(this.get_label("save")).appendTo(f);a.key=a.keyid,a.keyid.length>8&&(a.keyid=a.keyid.substr(a.keyid.length-8)),$.each(["keyid","user"],function(){c=c.replace("$"+this,a[this])}),g.text(c),e.submit(function(c){return c.stopPropagation(),c.preventDefault(),a.password=$("#enigmakeypassword").val(),a.password?void b.enigma_password_submit(a):void $("#enigmakeypassword").focus()}),setTimeout(function(){d.popup(),d.trigger("create"),d.popup("open"),h.focus()},200)}},rcmail.enigma_password_submit=function(a){if("compose"==this.env.action&&!a["compose-init"])return this.enigma_password_compose_submit(a);var b=$("<form>").attr({method:"post",action:a.action||location.href,style:"display:none"}).append($("<input>").attr({type:"hidden",name:"_keyid",value:a.key})).append($("<input>").attr({type:"hidden",name:"_passwd",value:a.password})).append($("<input>").attr({type:"hidden",name:"_token",value:this.env.request_token}));if($.each(a,function(a,c){0==a.indexOf("input")&&b.append($("<input>").attr({type:"hidden",name:a.substring(5),value:c}))}),a.iframe){var c="enigma_frame_"+(new Date).getTime();$("<iframe>").attr({style:"display:none",name:c}).appendTo(document.body);b.attr("target",c)}b.appendTo(document.body).submit()}),window.page_loading={},window.current_page_scroll=1,$("#select_balp_mobile").change(function(){window.location=$("#select_balp_mobile option:selected").val()}),$("#select_balp_mobile").click(function(a){a.stopPropagation(),a.preventDefault()}),$("#messagessearchfilter").click(function(a){a.stopPropagation(),a.preventDefault()}),window.location.href.indexOf("?_task=addressbook&_orig_source=")==-1||rcmail.env.cid||(window.location="?_task=addressbook&_source="+window.location.href.split("?_task=addressbook&_orig_source=").pop()),"mail"!=rcmail.env.task||rcmail.env.action&&""!=rcmail.env.action)if("mail"==rcmail.env.task&&"compose"==rcmail.env.action){$(".button_upload_photo").click(function(){$("#upload-popup").popup("close")}),rcmail.env.compose_commands=["send-attachment","remove-attachment","send","cancel","toggle-editor","list-adresses","pushgroup","search","reset-search","extwin","insert-response","save-response"],rcmail.env.drafts_mailbox&&rcmail.env.compose_commands.push("savedraft"),rcmail.env.isenigma&&rcmail.env.compose_commands.push("menu-open"),rcmail.enable_command(rcmail.env.compose_commands,"identities","responses",!0),rcmail.addEventListener("aftersend-attachment",show_uploadform).addEventListener("add-recipient",function(a){show_header_row(a.field,!0)});var c,d,e,f=["cc","bcc","replyto","followupto"];for(c=0;c<f.length;c++)d=f[c],e=$("#_"+d),e.length&&(e.on("change",{v:d},function(a){this.value&&show_header_row(a.data.v,!0)}),""!=e.val()&&show_header_row(d,!0))}else"mail"==rcmail.env.task&&"show"==rcmail.env.action?($(".mark_as_read").click(function(){$("#buttons-right-panel").panel("close")}),$(".mark_as_unread").click(function(){$("#buttons-right-panel").panel("close")}),$("#bounce_button_mobile").click(function(){$("#buttons-right-panel").panel("close")})):"addressbook"!=rcmail.env.task||rcmail.env.action&&""!=rcmail.env.action?"addressbook"==rcmail.env.task&&"show"==rcmail.env.action?($(".contactcontrollerphone .contactfieldcontent.text").each(function(){$(this).html('<a href="tel:'+$(this).html()+'">'+$(this).html()+"</a>")}),rcmail.register_command("delete_mobile",rcmail.delete_contact_mobile,!rcmail.env.readonly)):"addressbook"==rcmail.env.task&&"edit"==rcmail.env.action?($("select.addfieldmenu").change(function(){$("#contacttabs").trigger("create")}),$(".button_upload_photo").click(function(){$("#upload-popup").popup("close")})):"calendar"==rcmail.env.task?($(window).resize(function(){$("#calendarview-left-panel").panel("close")}),$(window).hashchange(function(a){var b=a.originalEvent.oldURL.split("#").pop();if(b)switch(b){case"event_show_dialog":$("#eventshow:ui-dialog").dialog("close");break;case"event_edit_dialog":$("#eventeditdialog:ui-dialog").dialog("close");break;case"eventeditpage":$.mobile.pageContainer.pagecontainer("change","./?_task=calendar")}})):"settings"==rcmail.env.task&&"edit-folder"==rcmail.env.action?(rcmail.env.mailbox=rcmail.env.folder,rcmail.enable_command("delete-folder",!0)):"settings"==rcmail.env.task&&"plugin.managesieve-action"==rcmail.env.action?($(".boxcontent").trigger("create"),rcmail.addEventListener("responseafterplugin.managesieve-action",function(a){$(".boxcontent").trigger("create")})):"settings"==rcmail.env.task&&"plugin.managesieve"==rcmail.env.action?$(document).on("click","table#filterslist tr",function(){var a=rcmail.filters_list.get_row_uid($(this).get(0));window.location.href=rcmail.env.comm_path+"&_action=plugin.managesieve-action&_framed=1&_fid="+a}):"settings"==rcmail.env.task&&"plugin.enigmakeys"==rcmail.env.action&&($(document).on("tap","table#keys-table td",function(){var a=rcmail.keys_list.get_row_uid($(this).parent().get(0));window.location.href=rcmail.env.comm_path+"&_action=plugin.enigmakeys&_a=info&_id="+a}),$(document).on("click","#page_keys_list a.enigma-key-import",function(){window.location.href=rcmail.env.comm_path+"&_action=plugin.enigmakeys&_a=import"}),$(document).on("click","#page_keys_list a.enigma-key-create",function(){window.location.href=rcmail.env.comm_path+"&_action=plugin.enigmakeys&_a=create"}),$(document).on("click",".jqm-enigma-key-create a.enigma-key-delete",function(){var a=rcmail.display_message(rcmail.get_label("enigma.keyremoving"),"loading"),b={_a:"delete",_keys:[window.location.href.split("&_id=").pop()]};rcmail.http_post("plugin.enigmakeys",b,a)})):($(".ui-title").html($("#directorylist_mobile li.selected a").first().text()),$("#directorylist_mobile li.selected a").first().addClass("ui-btn ui-btn-icon-right ui-icon-check"),$(window).resize(function(){$("#addressbook-left-panel").panel("close")}),$("#directorylist_mobile li a").click(function(){$("#addressbook-left-panel").panel("close"),$("#directorylist_mobile li a").removeClass("ui-btn-active"),window.page_loading={},rcmail.env.current_page=1,$(".ui-title").html($(this).clone().children().remove().end().text()),$("#directorylist_mobile").listview("refresh")}),$(".jqm-addressbook-cancel-searchbox").click(function(){$(".jqm-addressbook-header").show(),$(".jqm-addressbook-search-header").hide()}),$(".jqm-addressbook-open-searchbox").click(function(){$(".jqm-addressbook-header").hide(),$(".jqm-addressbook-search-header").show(),$(".jqm-addressbook-search-header input").focus()}),$("#quicksearchbox").click(function(){$("#quicksearchbox").focus()}),$(window).scroll(function(){if($(window).scrollTop()>200&&($(window).scrollTop()+$(window).height())/$(document).height()>=.95){var a=rcmail.env.current_page+1;if(a>0&&a<=rcmail.env.pagecount&&!window.page_loading[a]){window.page_loading[a]=!0;var b=rcmail.set_busy(!0,"loading"),c={};c._source=rcmail.env.source,rcmail.env.group&&(c._gid=rcmail.env.group),c._page=a,rcmail.env.search_request&&(c._search=rcmail.env.search_request),rcmail.http_request_mobile("list",c,b,function(){rcmail.env.current_page=a},function(){})}}}),rcmail.contact_list.addEventListener("clear",function(a){window.page_loading={},rcmail.env.current_page=1}));else{$(".ui-title").html($("#mailboxlist li.selected a").first().clone().children().remove().end().text()),$(window).resize(function(){$("#mailview-left-panel").panel("close")}),$("#mailboxlist li a").click(function(){$("#mailview-left-panel").panel("close"),$(".ui-title").html($(this).clone().children().remove().end().text()),$("#mailboxlist").listview("refresh")}),$(".jqm-mail-cancel-searchbox").click(function(){$(".jqm-mail-header").show(),$(".jqm-mail-search-header").hide()}),$(".jqm-mail-open-searchbox").click(function(){$(".jqm-mail-header").hide(),$(".jqm-mail-search-header").show(),$(".jqm-mail-search-header input").focus()}),$(".jqm-mail-cancel-buttons").click(function(){$(".jqm-mail-header").show(),$(".jqm-mail-buttons-header").hide(),$(".jqm-mail-buttons-showmore").addClass("ui-icon-caret-down"),$(".jqm-mail-buttons-showmore").removeClass("ui-icon-caret-up"),$(".jqm-mail-more-buttons-header").hide(),rcmail.message_list.clear_selection()}),$(".jqm-mail-buttons-showmore").click(function(){$(this).hasClass("ui-icon-caret-down")?($(this).removeClass("ui-icon-caret-down"),$(this).addClass("ui-icon-caret-up"),$(".jqm-mail-more-buttons-header").show()):($(this).addClass("ui-icon-caret-down"),$(this).removeClass("ui-icon-caret-up"),$(".jqm-mail-more-buttons-header").hide())}),$(".jqm-mail-more-buttons-header li").each(function(){$(this).find("a").hasClass("filterlink")&&($(this).find("a").addClass("ui-link ui-btn ui-corner-all ui-icon-filter ui-btn-icon-notext"),$(".jqm-mail-more-buttons-header .ui-controlgroup-controls .move").before($(this).html())),$(this).remove()}),$(document).on("click",".jqm-mail-more-buttons-header a.filterlink",function(){window.location.href=rcmail.env.comm_path+"&_action=plugin.managesieve-action&_framed=1"}),$("#quicksearchbox").click(function(){$("#quicksearchbox").focus()}),$(document).scroll(function(){"page_mail_list"==$.mobile.pageContainer.pagecontainer("getActivePage")[0].id&&$(window).scrollTop()>200&&($(window).scrollTop()+$(window).height())/$(document).height()>=.95&&window.current_page_scroll>1&&load_next_page()}),rcmail.message_list.addEventListener("clear",function(a){window.page_loading={},rcmail.env.current_page=1,window.current_page_scroll=2})}if(rcmail.message_list){var g=window.rcmail;rcmail.message_list.addEventListener("click",function(a){return!1}).addEventListener("dblclick",function(a){return!1}).addEventListener("keypress",function(a){return!1}).addEventListener("select",function(a){return!1}).addEventListener("dragstart",function(a){return!1}).addEventListener("dragmove",function(a){return!1}).addEventListener("dragend",function(a){return!1}).addEventListener("expandcollapse",function(a){return!1}).addEventListener("column_replace",function(a){return!1}),rcmail&&rcube_list_widget&&(rcube_list_widget.prototype.drag_row=function(a,b){if(!this.is_event_target(a))return!0;if(this.drag_active=!1,this.in_selection_before=!!(a&&a.istouch||this.in_selection(b))&&b,!this.in_selection_before){var c=rcube_event.get_modifier(a);this.select_row(b,c,!0)}return!1},rcube_list_widget.prototype.select_row=function(a,b,c,d){var e=this.selection.join(","),f=this.in_selection(a);this.last_selected&&this.rows[this.last_selected]&&$(this.rows[this.last_selected].obj).removeClass("focused").find(this.col_tagname()).eq(this.subject_col).removeAttr("tabindex"),this.toggleselect&&f&&!b?this.clear_selection():this.selection.join(",")!=e&&this.triggerEvent("select"),this.rows[a]&&($(this.rows[a].obj).addClass("focused"),this.focused&&this.focus_noscroll($(this.rows[a].obj).find(this.col_tagname()).eq(this.subject_col).attr("tabindex","0"))),this.selection.length||(this.shift_start=null),this.last_selected=a},rcube_list_widget.prototype.click_row=function(a,b){var c=rcube_event.get_mouse_pos(a),d=$("#mailview-left-panel").position(),e=d.left+272,f=c.x-e>50;return f?(this.highlight_row(b,!1),this.multi_selecting=!1,window.clearTimeout(window.show_timer),window.storePosition.topCoordinate=$(window).scrollTop(),window.previous_page="page_mail_list",this.clear_selection(),window.current_uid=b,this.last_selected=b,rcmail.set_message(b,"unread",!1),b&&rcmail.env.mailbox==rcmail.env.drafts_mailbox?rcmail.open_compose_step({_draft_uid:b,_mbox:rcmail.env.mailbox}):rcmail.show_message_mobile(b,{})):(this.selection.length||delete rcmail.env.uid,this.highlight_row(b,!0),this.multi_selecting=!0,rcmail.enable_command("delete","move","copy","mark","reply","forward",this.selection.length>0),this.selection.length?($(".jqm-mail-header").hide(),$(".jqm-mail-buttons-header").show(),this.selection.length>1?($(".jqm-mail-buttons-header .reply").hide(),$(".jqm-mail-buttons-header .forward").hide(),$(".jqm-mail-more-buttons-header .filterlink").hide(),$(".jqm-mail-more-buttons-header .reply-all").hide()):($(".jqm-mail-buttons-header .reply").show(),$(".jqm-mail-buttons-header .forward").show(),$(".jqm-mail-more-buttons-header .filterlink").show(),$(".jqm-mail-more-buttons-header .reply-all").show())):($(".jqm-mail-header").show(),$(".jqm-mail-buttons-header").hide(),$(".jqm-mail-buttons-showmore").addClass("ui-icon-caret-down"),$(".jqm-mail-buttons-showmore").removeClass("ui-icon-caret-up"),$(".jqm-mail-more-buttons-header").hide())),this.drag_start=!1,this.in_selection_before=!1,this.focus(),!1})}if(rcmail.contact_list){var g=window.rcmail;rcmail.contact_list.addEventListener("click",function(a){window.previous_page="page_addressbook_list",window.storePosition.topCoordinate=$(window).scrollTop(),g.contactlist_select_mobile(a)}).addEventListener("dragstart",function(a){return!1}).addEventListener("dragmove",function(a){return!1}).addEventListener("dragend",function(a){return!1})}}),rcmail.addEventListener("responseafterlist",function(a){window.current_page_scroll=rcmail.env.current_page+1,rcmail.env.current_page=1,rcmail.http_post("mobile.set_current_page",{})})),rcube_webmail.prototype.http_request_mobile=function(a,b,c,d,e){var f=this.url(a,b),g=this,h=this.triggerEvent("request"+a,b);if(void 0!==h){if(h===!1)return!1;f=this.url(a,h)}return f+="&_remote=1",this.log("HTTP GET: "+f),this.start_keepalive(),$.ajax({type:"GET",url:f,data:{_unlock:c?c:0},dataType:"json",success:function(a){g.http_response(a),d()},error:function(b,d,f){g.http_error(b,d,f,c,a),e()}})},rcube_webmail.prototype.delete_contact_mobile=function(){if(!rcmail.env.readonly&&confirm(rcmail.get_label("deletecontactconfirm"))){var a="contactdeleting",b="delete";return post_data={},post_data._source=rcmail.env.source,post_data._from=rcmail.env.action,post_data._cid=rcmail.env.cid,lock=rcmail.display_message(rcmail.get_label(a),"loading"),rcmail.env.group&&(post_data._gid=rcmail.env.group),rcmail.env.search_request&&(post_data._search=rcmail.env.search_request),rcmail.http_post(b,post_data,lock),window.location="?_task="+rcmail.env.task+"&_source="+rcmail.env.source,!0}},rcube_webmail.prototype.msglist_dbl_click_mobile=function(a){this.preview_timer&&clearTimeout(this.preview_timer),this.preview_read_timer&&clearTimeout(this.preview_read_timer);var b=a.get_single_selection();a.clear_selection(),window.current_uid=b,this.set_message(b,"unread",!1),b&&this.env.mailbox==this.env.drafts_mailbox?this.open_compose_step({_draft_uid:b,_mbox:this.env.mailbox}):b&&this.show_message_mobile(b,{})},rcube_webmail.prototype.show_message_mobile=function(a,b){if(a){$("#messagelist li").removeClass("selected"),$("#messagelist li#rcmrow"+a).addClass("selected");var e=(window,"show"),f="&_action="+e+"&_uid="+a+"&_mbox="+urlencode(this.env.mailbox);this.env.search_request&&(f+="&_search="+this.env.search_request),f+="&_caps="+urlencode(this.browser_capabilities()),this.env.extwin&&(f+="&_extwin=1"),$.mobile.pageContainer.pagecontainer("change",this.env.comm_path+f,b)}},rcube_webmail.prototype.contactlist_select_mobile=function(a){this.preview_timer&&clearTimeout(this.preview_timer);var c,f=this,g=!1;this.env.source?this.env.address_sources[this.env.source]:null;return(c=a.get_single_selection())&&f.load_contact_mobile(c,"show"),window.current_uid=c,this.enable_command("group-remove-selected",this.env.group&&a.selection.length>0&&g),this.enable_command("compose",this.env.group||a.selection.length>0),this.enable_command("export-selected","copy",a.selection.length>0),this.enable_command("edit",c&&g),this.enable_command("delete","move",a.selection.length>0&&g),!1},rcube_webmail.prototype.load_contact_mobile=function(a,b,c){var e="";window,this.contact_list?this.contact_list.data[a]:null;return!b||!a&&"add"!=b||this.drag_active||($("#contacts-table tr").removeClass("selected"),$("#contacts-table tr#rcmrow"+a).addClass("selected"),e="&_action="+b,this.env.search_request&&(e+="&_search="+this.env.search_request),e+="&_source="+this.env.source,e+="&_cid="+a,$.mobile.pageContainer.pagecontainer("change",this.env.comm_path+e,{})),!0},rcube_webmail.prototype.managesieve_add=function(){alert("managesieve_add"),this.load_managesieveframe(),this.filters_list.clear_selection()},rcube_webmail.prototype.load_managesieveframe=function(a){var b="undefined"!=typeof a&&null!=a;this.enable_command("plugin.managesieve-act","plugin.managesieve-del",b);var c=this.set_busy(!0,"loading");$.mobile.pageContainer.pagecontainer("change",this.env.comm_path+"&_action=plugin.managesieve-action&_framed=1"+(b?"&_fid="+a:"")+"&_unlock="+c,{})};var compose_headers={};